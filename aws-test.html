<!DOCTYPE html>
<html>
<head>
    <title>AWS S3 Test</title>
    <script type="module">
        // Simple AWS test without the React app complexity
        import { S3Client, ListObjectsV2Command } from 'https://cdn.skypack.dev/@aws-sdk/client-s3';
        import { fromCognitoIdentityPool } from 'https://cdn.skypack.dev/@aws-sdk/credential-provider-cognito-identity';

        const REGION = "us-east-2";
        const BUCKET = "blobular-audio";
        const IDENTITY_POOL_ID = "us-east-2:27944dd9-244f-44e0-9300-87d4baa87f2a";

        window.testAWS = async function() {
            const output = document.getElementById('output');
            output.innerHTML = '<p>Testing AWS S3 connection...</p>';
            
            try {
                const s3 = new S3Client({
                    region: REGION,
                    credentials: fromCognitoIdentityPool({
                        identityPoolId: IDENTITY_POOL_ID,
                        clientConfig: { region: REGION },
                    }),
                });

                console.log('S3 client created');
                output.innerHTML += '<p>‚úÖ S3 client created</p>';

                const command = new ListObjectsV2Command({
                    Bucket: BUCKET,
                    Prefix: "audio-pond/",
                    MaxKeys: 5
                });

                console.log('About to list objects...');
                output.innerHTML += '<p>üîÑ Listing objects...</p>';

                const response = await s3.send(command);
                console.log('S3 response:', response);
                
                output.innerHTML += `<p>‚úÖ Success! Found ${response.KeyCount || 0} objects</p>`;
                output.innerHTML += `<pre>${JSON.stringify(response, null, 2)}</pre>`;
                
            } catch (error) {
                console.error('AWS Test failed:', error);
                output.innerHTML += `<p>‚ùå Error: ${error.message}</p>`;
                output.innerHTML += `<pre>${error.stack}</pre>`;
            }
        };
    </script>
</head>
<body>
    <h1>AWS S3 Connection Test</h1>
    <button onclick="testAWS()">Test AWS S3</button>
    <div id="output"></div>
</body>
</html>
